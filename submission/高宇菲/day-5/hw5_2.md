# 答题卡

## 1 总训练时间与理想时间

### 1.1

- 前向阶段
填充流水线需要 p-1 个microbatch时间，然后才进入稳定流水，因此 $T_{fwd} = (m+p-1)t_f$

- 反向阶段
同理，需要$T_{bwd} = (m+p-1)t_b$

​带入题设，总时间为 $T_{fwd} + T_{bwd} = 66ms$


### 1.2
$T_{ideal} = 8*6 = 48 ms$

### 1.3
$66 / 48 = 1.375$

## 2 若将 microbatch 数增加为 $$m = 16$$，bubble ratio 会如何变化？请分析并说明原因
$T_{total} = (2+4)*(16+4-1) = 114 ms $

$T_{ideal} = 16*6 = 96 ms$

$Bubble Ratio = 114/96 = 1.1875 $

microbatch数量增加，效率得到提升。因为流水线的填充和排空阶段(各需要p-1个时间步) 占总执行时间的比例下降。

## 3. 与 Gpipe 相比，1F1B 调度策略在哪些方面优化了流水线利用率？

Gpipe 先全部forward，然后全部backward， 因此存在pipeline填充和排空阶段，bubble较多，GPU空闲时间较多

1F1B 每处理一个 microbatch 的前向，就立刻开始对其反向传播（在流水线允许的条件下），使得前向与反向交错展开，负载更均衡。